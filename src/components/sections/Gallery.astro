---
import { Image } from 'astro:assets';
const imageFiles = await Astro.glob('/src/img/gallery/*.{jpeg,jpg,png,gif}');

const { title, description } = Astro.props
---

<section id="gallery">
  <div class="container margin-block-36">
    <ul id="my-gallery" class="list gallery">
      <!-- {
        imageFiles.map((img) => (
          <Image
            src={img.default}
            width="600"
            alt="Photo of a pizza"
            class="mb-3 w-full rounded"
          />
        ))
      } -->

      {
      imageFiles.map((img, index) => (
        <li class="grid-item hidden" id={`img-${index}`}>
            <a data-pswp-width="1200" data-pswp-height="1600" class="image" href={img.default.src} data-src={img.default.src}>
            <Image width={300} height={300} src={img.default} alt={`Malkuch's Yard and Tree Service Gallery - image ${index}`} />
          </a>
        </li>
      ))
      }
    </ul>
    <button class="btn margin-block-start-8" data-type="outline" onclick="previousPage()">Previous</button>
    <button class="btn margin-block-start-8" data-type="outline" onclick="nextPage()">Next</button>
  </div>
</section>

<script is:inline>
  // Your existing pagination script
  const imagesPerPage = 8;
  let currentPage = 0;
  let totalImages = document.querySelectorAll('.grid-item').length;
  let currentImageIndex = -1;

  function showCurrentPage() {
    const start = currentPage * imagesPerPage;
    const end = start + imagesPerPage;
    document.querySelectorAll('.grid-item').forEach((item, index) => {
      item.classList.toggle('hidden', !(index >= start && index < end));
    });
  }

  function nextPage() {
    currentPage = (currentPage + 1) % Math.ceil(totalImages / imagesPerPage);
    showCurrentPage();
  }

  function previousPage() {
    currentPage = (currentPage - 1 + Math.ceil(totalImages / imagesPerPage)) % Math.ceil(totalImages / imagesPerPage);
    showCurrentPage();
  }

  document.addEventListener('DOMContentLoaded', showCurrentPage);

</script>

<script>
  import PhotoSwipeLightbox from 'photoswipe/lightbox';
  import 'photoswipe/style.css';

  const lightbox = new PhotoSwipeLightbox({
    gallery: '#my-gallery',
    children: 'a',
    pswpModule: () => import('photoswipe')
  });
  lightbox.init();
</script>
